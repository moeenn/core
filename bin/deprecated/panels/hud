#! /bin/sh

#colors
fg1='^fg(#1db5a2)'		# icons
fg2='^fg(#DFE0E1)'		# text
fg3='^fg(#717171)'		# sepa

reset='^fg()'

#icons
clock="$fg1^i(/home/moeen/bin/icons/clock.xbm)$reset"
wifi="$fg1^i(/home/moeen/bin/icons/wifi.xbm)$reset"
volume1="$fg1^i(/home/moeen/bin/icons/volume.xbm)$reset"
volume2="$fg1^i(/home/moeen/bin/icons/volume2.xbm)$reset"
battery="$fg1^i(/home/moeen/bin/icons/battery.xbm)$reset"
sepa="$fg3^i(/home/moeen/bin/icons/sepa.xbm)$reset"

time() {
	date +'%H:%M'
}

vol_icon() {
	state=`pacmd list-sinks | grep "active port" | cut -d ":" -f 2`
	case $state in 
		" <analog-output-headphones>" )		echo "$volume2"			;;
		" <analog-output-speaker>"	  )		echo "$volume1"			;;
	esac
}

volume() {
	vol=`pactl list sinks | grep "Volume" | cut -d "/" -f2 | head -1`
	muted=$(pacmd list-sinks | grep "mute" | head -1 | cut -d ":" -f 2)
	
	case $muted in 
		" yes" 	)	vol='0%'	
					echo $vol	;;
		" no"	)	echo $vol	;;
	esac	
}	


battery() {
	acpi | cut -d "," -f 2
}	

net() {
	essid=`iwconfig wlp6s0 | awk 'NR==1 {print $4}' | cut -d '"' -f2`
	echo "$essid"
}
	

( echo "  $wifi $(net)   $sepa   $(vol_icon) $(volume)   $sepa   $battery$(battery)   $sepa   $clock $(time)  "
sleep 5 ) | dzen2 -geometry 400x30+958+8 -ta center

  
