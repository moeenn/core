#! /bin/bash

sink=0				# pulseaudio sink [Default = 0]
spk_off_count=0
spk_on_count=0

spk_off() {
	if [ $spk_off_count -eq 0 ]; then
		# mute when output to speaker
		pactl set-sink-mute $sink 1			# 1 = mute
		echo "sound off"
		spk_off_count=1
		spk_on_count=0
	fi	
}

spk_on() {
	if [ $spk_on_count -eq 0 ]; then
		# unmute sound when head-phones are plugged-in
		pactl set-sink-mute $sink 0			# 0 = unmute
		echo "sound on"
		spk_on_count=1
		spk_off_count=0
	fi
}

# daemonize the process
while true; do
		vol_state=`pacmd list-sinks | grep "active port" | cut -d ":" -f 2`
		
		case $vol_state in
			" <analog-output-headphones>"	)		spk_on		;;	
			" <analog-output-speaker>"		)		spk_off		;;
		esac
			
		# loop cycle delay [ i.e. 1 second(s) ]
		sleep 1		
done
